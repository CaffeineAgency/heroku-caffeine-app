{% extends "base.html" %}

{% block content %}

<script type="application/javascript">
function uplwurl() {
	console.log("sending request");
	$("span#spd")[0].innerText = "In progress..."
	var form = $('div#fuwrl')[0];
	formData = {
		mode: form.children[0].value,
		u: form.children[1].children[0].value
	}
	$.ajax({
		type: 'GET',
		url: '/acollection',
		data: formData,
		encode: true
	}).done(function(data) {
		console.log(data);
		$("span#spd")[0].innerText = data
	}).fail(function(data) {
		console.log(data);
		$("span#spd")[0].innerText = "Something went wrong. Check console for more info."
	});
}

function chkbycode() {
	console.log("sending request");
	$("span#sstat")[0].innerText = "In progress..."
	var form = $('div#fubl')[0];
	formData = {
		mode: form.children[0].value,
		id: form.children[1].children[0].value
	}
	$.ajax({
		type: 'GET',
		url: '/acollection',
		data: formData,
		encode: true
	}).done(function(data) {
		console.log(data);
		$("span#sstat")[0].innerText = data
	}).failed (function(data) {
		console.log(data);
		$("span#sstat")[0].innerText = "Something went wrong. Check console for more info."
	});
}
</script>
<div class="container-fluid">
	<br><br>
	<div class="alert text-center">
		<h3>Upload file with link</h3>
		<div id="fuwrl">
			<input name="mode" value="ubl" hidden>
			<div class="input-group">
				<input placeholder="URL" class="form-control" type="text" name="u" required>
				<span class="input-group-btn">
					<button onclick="uplwurl()" class="btn btn-secondary" type="button">UPLOAD!</button>
				</span>
			</div>
		</div>
		<br>
		<p><b>Your operation id:</b><br>
			<span id="spd">[############################]</span>
		</p>
	</div>
	<div class="alert text-center">
		<h3>Check async operation</h3>
		<div id="fubl">
			<input name="mode" value="chk" hidden>
			<div class="input-group">
				<input placeholder="ID" class="form-control" type="text" name="id" required>
				<span class="input-group-btn">
					<button onclick="chkbycode()" class="btn btn-secondary" type="button">CHECK!</button>
				</span>
			</div>
		</div>
		<br>
		<p><b>Status:</b><br>
			<span id="sstat">[############################]</span>
		</p>
	</div>
</div>
{% endblock %}